---
lang: zh-CN
title: 内存管理
order: 9
description: 操作系统
---











## 1.虚拟内存管理

### 1.1局部性原理

在了解这部分知识之前，我要先告诉大家一个常见的**局部性原理**：

::: info

程序局部性原理表现为：**时间局部性和空间局部性**。时间局部性是指如果程序中的某条指令一旦执行，则不久之后该指令可能再次被执行；如果某块数据被访问，则不久之后该数据可能再次被访问。空间局部性是指一旦程序访问了某个存储单元，则不久之后，其附近的存储单元也将被访问。

:::

说白了就是**一个变量在程序运行过程中，如果被引用过一次，那后续很有可能会再被引用到；一个变量被访问到过后，这个变量所在的位置附近的位置很有可能在程序后续运行中被访问到**。

下面我们通过一段代码来看看局部性原理：

```java
public int sum(int[] array) {
        int sum = 0;
        for (int i = 0; i < array.length; i++) {
            sum = sum + array[i];
        }
        return sum;
}
```

从上面的这段代码来看，就是一个很简单的数组元素求和，这里我们主要看 sum 和 array 两个变量，我们可以看到 sum 在每次循环中都会用到，另外它只是一个简单变量，所以我们可以看到，sum 是符合我们上面提到的时间局部性，再访问一次后还会被继续访问到，但是它不存在我们所说的空间局部性了。

相反的，array 数组中的每个元素只访问一次，另外数组底层的存储是连续的，所以 array 变量符合我们上面提到的空间局部性，但是不符合时间局部性。



### 2.2为什么需要虚拟内存？

![image.png](https://cdn.xiaolincoding.com//mysql/other/769ed056eefb1e3d6419472bff87d036.png)